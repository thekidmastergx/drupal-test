<?php

function sfafeeds_block($op = 'list', $delta = 0) {
  $block = array();

  switch ($op) {
    case 'list' :
      $block[0]['info'] = t('SFA Feeds');
      break;
    case 'view' :
      $block_content = t('We Are SFA!');
      $block["subject"] = t('This is Content!');
      $block["content"] = $block_content;
      break;
  }
  return $block;
}

function sfafeeds_cron(){
  $node = new stdClass();

  $node->name = "Title";
  $node->title = $node->name;
  $node->body = "Lorem Ipsum";
  $node->type = 'story'; //This can be any node type
  $node->created = time();
  $node->changed = $node->created;
  $node->promote = 1; // Display on front page ? 1 : 0
  $node->sticky = 0;  // Display top of page ? 1 : 0
  $node->format = 2;  // 1:Filtered HTML, 2: Full HTML
  $node->status = 1;   // Published ? 1 : 0
  $node->language = 'en';

  // [service]
  // keyring(service) -> key
  // authorize(service,key) -> token
  // build_link(service,token) -> request
  // fetch_post(request) -> json , xml
  // decode_json(json) -> obj
  // decode_xml(xml) -> obj
  // model_data(obj) -> node
  //  -> boolean
  // node_save(node)

  if ($node = node_submit($node)) {
    node_save($node);
    drupal_set_message(t("Node ".$node->title." added correctly"));
  } else {
    drupal_set_message(t("Node ".$node->title." added incorrectly"), "error");
  }
}
